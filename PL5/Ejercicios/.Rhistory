#Seleccionamos el directorio de trabajo
directorio <- dirname(parent.frame(2)$ofile)
setwd(directorio)
# Ejercicio 1
# K-vecinos
muestra <- matrix(c(4, 4, 4, 3, 5, 5, 1, 1, 5, 4), 2,5)
muestra <- t(muestra)
#Matriz que guarda las distancias entre puntos
distancias <- as.matrix(dist(muestra))
distancias <- matrix(distancias, 5, 5)
# Ordenamos las distancias de menor a mayor
for(i in 1:5){
distancias[,i] = sort(distancias[,i])
}
distanciasOrdenadas <- distancias
#Si la distancia es mayor a 2,5 es anomalo
for(i in 1:5){
if(distanciasOrdenadas[4,i] > 2.5) {
cat("[", i, "] es un suceso anomalo o outlier\n")
}
}
# k-vecinos con entrenamiento
# la libreria kknn realiza clasificacion de k-vecinos usando un training set
# despues se puede aplicar a un test set
# install.packages("kknn")
library(kknn)
#Seleccionamos el directorio de trabajo
directorio <- dirname(parent.frame(2)$ofile)
setwd(directorio)
# Libreria por defecto en R
Data<-iris
# Datos de muestra
Muestra <- sample(1:150, 50)
conjunto_test <- Data[Muestra, ]
# Aprendizaje
conjunto_aprendizaje <- Data[-Muestra, ]
# Ejecuto algoritmo y entreno modelo
modelo <- train.kknn(Species ~ ., data = conjunto_aprendizaje, kmax = 9)
resultado_prediccion <- predict(modelo, conjunto_test[, -5])
# Matriz de confusion
matriz_confusion <- table(conjunto_test[, 5], resultado_prediccion)
print(matriz_confusion)
# Precision
acierto <- (sum(diag(matriz_confusion)))/sum(matriz_confusion)
cat("Acierto: ", acierto, "\n")
# Error
error <- 1 - acierto
cat("Error: ", error, "\n")
# Calidad de la representacion
plot(modelo)
#Seleccionamos el directorio de trabajo
directorio <- dirname(parent.frame(2)$ofile)
setwd(directorio)
# Utilizamos el modelo multivariante
url <- "https://raw.githubusercontent.com/selva86/datasets/master/ozone.csv"
ozono <- read.csv(url)
modelo <- lm(ozone_reading~., data=ozono)
distancia_cooks <- cooks.distance(modelo)
valor_maximo <- 4*mean(distancia_cooks, na.rm=T)
# Dibujamos la distancia de cooks
plot(distancia_cooks, pch="*", cex=2, main="Estudio de valores anomalos con la distancia de Cooks")
# Dibujamos la linea que separa los datos normales de los outliers
abline(h = valor_maximo, col="red")
# Ponemos etiquetas para identificar los outliers
text(x=1:length(distancia_cooks)+1, y=distancia_cooks, labels=ifelse(distancia_cooks>valor_maximo,names(distancia_cooks),""), col="red")
outliers <- list()
for(i in 1:length(distancia_cooks)){
if(distancia_cooks[i] > valor_maximo) { # Si los datos estan fuera del rango de valores normales
outliers <- append(outliers, i) # Se aÃ±aden a la lista de anomalos
}
}
# Imprimimos por pantalla la lista
matriz <- matrix(unlist(outliers))
cat("Los datos outliers son:\n")
cat(matriz, sep =', ')
cat("\n")
